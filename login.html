<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Self-Defense Education</title>
    <link rel="stylesheet" href="login.css">
    <link rel="stylesheet" href="../../../styles/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&family=Roboto+Condensed&display=swap"
        rel="stylesheet">
    <link rel="shortcut icon" href="../../../images/Capture.PNG" type="image/x-icon">
</head>

<body>
    <header>
        <div class="navbar">
            <div>
                <img class="logo" src="../../../images/flat-design-safety-logo-template_23-2149336546.avif" alt="">
            </div>
            <div class="logoTxt">
                <h2>SafeZone Community Network</h2>
            </div>
            <div class="links">
                <ul>
                    <a href="../../../index.html">
                        <li>Home</li>
                    </a>
                    <li>Services
                        <ul class="submenu">
                            <a href="../incidentReport/Incident_reporting.html">
                                <li>Incident Reporting System</li>
                            </a>
                            <li>Crime Mapping</li>
                            <li>Safety Resources</li>
                            <li>Volunteer Opportunities</li>
                            <a href="../education/education.html">
                                <li>Education and Awareness</li>
                            </a>
                            <li>Emergency Alert</li>
                        </ul>
                    </li>
                    <a href="../../../contact.html">
                        <li>Contact Us</li>
                    </a>
                </ul>
            </div>
            <div class="navBtn">
                <a href="login.html" id="loginBtn">Login</a>
                <a href="../signup/signup.html" class="btn">Sign Up</a>
            </div>
        </div>
    </header>
    <div class="wrapper">
        <div class="inner">
            <form id="loginForm">
                <h3>Login here</h3>
                <div class="form-holder">
                    <span class="lnr lnr-user"></span>
                    <input type="text" id="username" class="form-control" placeholder="Email or Phone no">
                </div>
                <div class="form-holder">
                    <span class="lnr lnr-lock"></span>
                    <input type="password" id="password" class="form-control" placeholder="Password">
                </div>
                <button type="submit">
                    <span>Login</span>
                </button>
            </form>
        </div>
    </div>

    <script>
        document.getElementById('loginForm').addEventListener('submit', async function (event) {
            event.preventDefault();

            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            try {
                const response = await fetch('http://localhost:3000/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email: username, password: password })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error);
                }
                const responseData = await response.json();
            alert(responseData.message); // Display success message

            // Redirect to Education and Awareness page
            window.location.href = '../education/education.html';} 
            catch (error) {
                console.error('Login Error:', error.message);
                alert('Login failed: ' + error.message); // Display error message
            }
        });
    </script>
</body>

</html>